<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mindcards</title>
    <style>
                /* Base styles for the body */
                body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #1a1a1a;
            color: #f4f4f4;
        }
        /* Header styling */
        .header {
            text-align: center;
            margin-bottom: 20px;
        }
        /* Container for buttons */
        .button-container {
            display: flex;
            justify-content: flex-end;
            margin-bottom: 10px;
        }
        /* Table styling */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        /* Table header and cell styling */
        th, td {
            padding: 10px;
            text-align: left;
            resize: horizontal;
            overflow: auto;
        }
        /* Table header specific styling */
        th {
            background-color: #007BFF;
            color: white;
            border-bottom: 2px solid #0056b3;
        }
        /* Table cell border */
        td {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        /* Input field styling */
        input[type="text"] {
            width: 100%;
            padding: 8px;
            box-sizing: border-box;
            background-color: #333;
            color: #f4f4f4;
            border: none;
            border-radius: 4px;
        }
        /* Button styling */
        button {
            margin-left: 10px;
            padding: 10px 20px;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        /* Button hover effect */
        button:hover {
            background-color: #0056b3;
        }
        /* File input styling */
        input[type="file"] {
            margin-left: 10px;
            padding: 10px;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        /* File input hover effect */
        input[type="file"]:hover {
            background-color: #0056b3;
        }
        /* Stopwatch styling */
        #stopwatch {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 24px;
            font-weight: bold;
        }
        /* Overlay for prompt */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        /* Prompt box styling */
        .prompt-box {
            background-color: #2a2a2a;
            padding: 20px;
            border-radius: 8px;
            width: 80%;
            max-width: 500px;
        }
        /* Prompt description styling */
        .prompt-description {
            margin-bottom: 15px;
        }
        /* Title input container styling */
        .title-input-container {
            margin-bottom: 10px;
        }
        .info-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #2a2a2a;
            padding: 20px;
            border-radius: 8px;
            z-index: 1001;
            max-width: 80%;
            max-height: 80%;
            overflow-y: auto;
        }
        .info-popup h2 {
            margin-top: 0;
        }
        .info-popup ul {
            padding-left: 20px;
        }
        .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            cursor: pointer;
        }
    </style>
</head>
<body>

<!-- Header -->
<div class="header">
    <h1>Mindcards</h1>
</div>

<!-- Stopwatch display -->
<div id="stopwatch">00:00:00</div>

<!-- Button container -->
<div class="button-container">
    <button id="addCardsButton" onclick="showPrompt()">Add Cards</button>
    <button id="stopwatchButton" onclick="toggleStopwatch()">Start Stopwatch</button>
    <button id="downloadButton" onclick="downloadTXT()">Download</button>
</div>

<!-- Main table -->
<table id="mindcardTable">
    <thead>
        <tr>
            <th>Question Type</th>
            <th>Keyword</th>
            <th>Answer</th>
            <th>Your Answer</th>
            <th></th>
        </tr>
    </thead>
    <tbody id="tableBody">
    </tbody>
</table>

<script>
    // Get references to DOM elements
    const tableBody = document.getElementById("tableBody");
    const stopwatch = document.getElementById("stopwatch");
    const stopwatchButton = document.getElementById("stopwatchButton");
    const downloadButton = document.getElementById("downloadButton");
    const addCardsButton = document.getElementById("addCardsButton");
    
    // Initialize stopwatch variables
    let stopwatchInterval;
    let stopwatchRunning = false;
    let stopwatchStarted = false;
    
    // Define question types
    const questionTypes = [
        "Alpha Definition 1",
        "Beta Reason 1",
        "Gamma Features 1",
        "Delta Method 1",
        "Epsilon Impact 1",
        "Zeta Parts 1",
        "Eta Challenges 1",
        "Theta Exceptions 1"
    ];
    
    // Function to generate the next question type
    function getNextQuestionType(currentType) {
        const [base, type, number] = currentType.split(' ');
        const nextNumber = parseInt(number) + 1;
        return `${base} ${type} ${nextNumber}`;
    }
    
    // Function to add a new row to the table
    function addRow(questionType = "", keyword = "", answer = "", yourAnswer = "", afterRow = null) {
        const newRow = document.createElement("tr");
    
        // Create table cells
        const questionTypeCell = document.createElement("td");
        const keywordCell = document.createElement("td");
        const answerCell = document.createElement("td");
        const yourAnswerCell = document.createElement("td");
        const actionCell = document.createElement("td");
    
        // Create and configure question type input
        const questionTypeInput = document.createElement("input");
        questionTypeInput.type = "text";
        questionTypeInput.value = questionType || questionTypes[0];
        questionTypeInput.placeholder = "Enter question type";
        questionTypeInput.disabled = stopwatchRunning;
        questionTypeCell.appendChild(questionTypeInput);
    
        // Create and configure keyword input
        const keywordInput = document.createElement("input");
        keywordInput.type = "text";
        keywordInput.value = keyword;
        keywordInput.disabled = stopwatchRunning;
        keywordCell.appendChild(keywordInput);
    
        // Create and configure answer input
        const answerInput = document.createElement("input");
        answerInput.type = "text";
        answerInput.value = answer;
        answerInput.disabled = stopwatchRunning;
        answerInput.style.display = stopwatchRunning ? "none" : "block";
        answerCell.appendChild(answerInput);
    
        // Create and configure your answer input
        const yourAnswerInput = document.createElement("input");
        yourAnswerInput.type = "text";
        yourAnswerInput.value = yourAnswer;
        yourAnswerInput.readOnly = !stopwatchRunning;
        yourAnswerInput.style.display = (!stopwatchStarted) ? "none" : "block";
        yourAnswerCell.appendChild(yourAnswerInput);
    
        // Add action buttons if stopwatch is not running
        if (!stopwatchRunning) {
            const addButton = document.createElement("button");
            addButton.textContent = "+";
            addButton.onclick = () => duplicateRow(newRow);
            actionCell.appendChild(addButton);
    
            const deleteButton = document.createElement("button");
            deleteButton.textContent = "🗑️";
            deleteButton.onclick = () => deleteRow(newRow);
            actionCell.appendChild(deleteButton);
        }
    
        // Append cells to the row
        newRow.appendChild(questionTypeCell);
        newRow.appendChild(keywordCell);
        newRow.appendChild(answerCell);
        newRow.appendChild(yourAnswerCell);
        newRow.appendChild(actionCell);
    
        // Insert the new row into the table
        if (afterRow) {
            afterRow.parentNode.insertBefore(newRow, afterRow.nextSibling);
        } else {
            tableBody.appendChild(newRow);
        }
    }
    
    // Function to duplicate a row
    function duplicateRow(row) {
        const cells = row.getElementsByTagName("td");
        const currentQuestionType = cells[0].firstChild.value;
        const nextQuestionType = getNextQuestionType(currentQuestionType);
        addRow(
            nextQuestionType,
            cells[1].firstChild.value,
            cells[2].firstChild.value,
            cells[3].firstChild.value,
            row
        );
    }
    
    // Function to delete a row
    function deleteRow(row) {
        if (tableBody.children.length > 1) {
            tableBody.removeChild(row);
        }
    }
    
    // Function to toggle stopwatch
    function toggleStopwatch() {
        if (!stopwatchRunning) {
            startStopwatch();
        } else {
            resetStopwatch();
        }
    }
    
    // Function to start stopwatch
    function startStopwatch() {
        if (!stopwatchStarted) {
            stopwatchStarted = true;
            stopwatch.style.display = "block";
        }
        stopwatchRunning = true;
        toggleTableInputs();
        stopwatchButton.textContent = "Reset Stopwatch";
        downloadButton.style.display = "none";
        addCardsButton.style.display = "none";
        startTimer();
    }
    
    // Function to reset stopwatch
    function resetStopwatch() {
        stopwatchRunning = false;
        toggleTableInputs();
        clearInterval(stopwatchInterval);
        stopwatch.textContent = "00:00:00";
        stopwatchButton.textContent = "Start Stopwatch";
        downloadButton.style.display = "inline-block";
        addCardsButton.style.display = "inline-block";
    }
    
    // Function to toggle table inputs based on stopwatch state
    function toggleTableInputs() {
        const rows = tableBody.getElementsByTagName("tr");
        for (let i = 0; i < rows.length; i++) {
            const cells = rows[i].getElementsByTagName("td");
            const questionTypeInput = cells[0].firstChild;
            const keywordInput = cells[1].firstChild;
            const answerInput = cells[2].firstChild;
            const yourAnswerInput = cells[3].firstChild;
            const actionCell = cells[4];
    
            questionTypeInput.disabled = stopwatchRunning;
            keywordInput.disabled = stopwatchRunning;
            yourAnswerInput.readOnly = !stopwatchRunning;
            yourAnswerInput.style.display = (!stopwatchStarted) ? "none" : "block";
            answerInput.style.display = stopwatchRunning ? "none" : "block";
            actionCell.style.display = stopwatchRunning ? "none" : "block";
        }
    }
    
    // Function to start the timer
    function startTimer() {
        let seconds = 0;
        let minutes = 0;
        let hours = 0;
    
        stopwatchInterval = setInterval(() => {
            seconds++;
            if (seconds === 60) {
                seconds = 0;
                minutes++;
            }
            if (minutes === 60) {
                minutes = 0;
                hours++;
            }
    
            const displaySeconds = seconds < 10 ? `0${seconds}` : seconds;
            const displayMinutes = minutes < 10 ? `0${minutes}` : minutes;
            const displayHours = hours < 10 ? `0${hours}` : hours;
    
            stopwatch.textContent = `${displayHours}:${displayMinutes}:${displaySeconds}`;
        }, 1000);
    }
    
    // Function to show the add cards prompt
    function showPrompt() {
        const overlay = document.createElement('div');
        overlay.className = 'overlay';
        overlay.innerHTML = `
            <div class="prompt-box">
                <div class="prompt-description">
                    Please enter keywords separated by commas.
                </div>
                <div id="keywordInput">
                    <input type="text" id="keywordsInput" placeholder="Enter keywords (comma-separated)">
                </div>
                <button onclick="createCards()">Create Cards</button>
                <button onclick="importCards()">Import Cards</button>
                <button onclick="closePrompt()">Close</button>
            </div>
        `;
        document.body.appendChild(overlay);
    }
    
    // Function to close the prompt
    function closePrompt() {
        const overlay = document.querySelector('.overlay');
        if (overlay) {
            document.body.removeChild(overlay);
        }
    }
    
    // Function to create cards based on entered keywords
    function createCards() {
        const keywordsInput = document.getElementById('keywordsInput');
        const keywords = keywordsInput.value.split(',').map(k => k.trim()).filter(k => k);
        
        keywords.forEach(keyword => {
            questionTypes.forEach(questionType => {
                addRow(questionType, keyword, "", "");
            });
        });
    
        closePrompt();
    }
    
    // Function to import cards from a file
    function importCards() {
        const input = document.createElement('input');
        input.type = 'file';
        input.accept = '.txt';
        input.onchange = function(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const content = e.target.result.trim();
                    const rows = content.split(/\n\s*\n/);
                   
                    rows.forEach(row => {
                        const lines = row.split("\n");
    
                        if (lines.length === 4) {
                            const questionTypeLine = lines[0].replace('Question Type: ', '').trim();
                            const keywordLine = lines[1].replace('Keyword: ', '').trim();
                            const answerLine = lines[2].replace('Answer: ', '').trim();
                            const yourAnswerLine = lines[3].replace('Your Answer: ', '').trim();
    
                            addRow(questionTypeLine, keywordLine, answerLine, yourAnswerLine);
                        }
                    });
    
                    closePrompt();
                };
                reader.readAsText(file);
            }
        };
        input.click();
    }
    
    // Function to download the table content as a TXT file
    function downloadTXT() {
        const rows = tableBody.getElementsByTagName("tr");
        let content = "";
    
        for (let i = 0; i < rows.length; i++) {
            const cells = rows[i].getElementsByTagName("td");
            const questionType = cells[0].firstChild.value;
            const keyword = cells[1].firstChild.value;
            const answer = cells[2].firstChild.value;
            const yourAnswer = cells[3].firstChild.value;
    
            content += `Question Type: ${questionType}\nKeyword: ${keyword}\nAnswer: ${answer}\nYour Answer: ${yourAnswer}\n\n`;
        }
    
        const blob = new Blob([content], { type: "text/plain" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "mindcards.txt";
        a.click();
        URL.revokeObjectURL(url);
    }
    
    // Function to show app information
    function showAppInfo() {
        const infoPopup = document.createElement('div');
        infoPopup.className = 'info-popup';
        infoPopup.innerHTML = `
            <h2>Mindcards App Features</h2>
            <p>Welcome to Mindcards! Here's a brief overview of the app's features:</p>
            <ul>
                <li>Create flashcards with various question types</li>
                <li>Add multiple cards at once using keywords</li>
                <li>Import and export cards</li>
                <li>Use a stopwatch for timed study sessions</li>
            </ul>
            <h3>Question Types:</h3>
            <ul>
                ${questionTypes.map(type => `<li>${type}</li>`).join('')}
            </ul>
            <p>The numbering system automatically increments (e.g., "Alpha Definition 1" -> "Alpha Definition 2") when duplicating cards.</p>
            <button onclick="closeAppInfo()">Close</button>
        `;
        document.body.appendChild(infoPopup);
    }
    
    // Function to close app information popup
    function closeAppInfo() {
        const infoPopup = document.querySelector('.info-popup');
        if (infoPopup) {
            document.body.removeChild(infoPopup);
            showPrompt(); // Show the Add Cards prompt immediately after closing the app info
        }
    }
    
    // Show app information when the page loads
    window.onload = function() {
        showAppInfo();
        addRow(); // Add a blank card when the page loads
    };
    </script>
</body>
</html>
